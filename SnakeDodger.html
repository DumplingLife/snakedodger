
<!doctype html>
<html>
    <head>
        <title>Snake Dodger</title>
		<style>
			#again
			{
				position: absolute;
				right: 10px;
				top: 10px;
				background-color: cyan;
				border: 3px solid gray;
				border-radius: 30px;
				color: orange;
				font-family: cursive;
			}
			#info
			{
				position: absolute;
				right: 10px;
				font-family: cursive;
			}
			#score
			{
				position: absolute;
				right: 10px;
				bottom: 6px;
				font-family: cursive;
			}
            #highscore
            {
                position: absolute;
				right: 10px;
				font-family: cursive;
            }
            #settings
            {
                position: absolute;
                top: 45%;
                right: 10px;
                width: 70px;
                height: 70px;
            }
			#mainpage
			{
				width: 100%;
				height: 100%;
				display: none;
			}
			#startpage
			{
				width: 100%;
				height: 100%;
			}
			#play, #surv, #tutor
			{
				font-family: Courier, monospace;
				position: absolute;
				cursor: pointer;
			}
			#play:hover, #surv:hover, #tutor:hover
			{
				text-decoration: underline;
			}
			#shop
			{
				font-family: Courier, monospace;
				position: absolute;
				cursor: pointer;
			}
			#shop:hover
			{
				text-decoration: underline;
			}
			#startImg
			{
				image-rendering: pixelated;
				display: block;
				margin: auto;
			}
			#shoppage
			{
				display: none;
				width: 100%
				height: 100%;
			}
			#back
			{
				cursor: pointer;
				margin: 0;
				padding: 0;
			}
			#back:hover
			{
				text-decoration: underline;
			}
			#gold
			{
				position: absolute;
				top: 0;
				right: 0;
				margin: 0;
				color: #dbaa41;
			}
			.skinCrate
			{
				border-style: solid;
				background-size: contain;
				background-repeat: no-repeat;
				image-rendering: pixelated;
				margin: 0;
				position: absolute;
			}
			.title
			{
				text-align: center;
				margin: 0;
			}
			.purchase
			{
				text-align: center;
				vertical-align: text-bottom;
				cursor: pointer;
			}
			.purchase:hover
			{
				text-decoration: underline;
			}
			#common 
			{
				border-color: red;
				background-image: url(commonskin.png);
			}
			#common .title {color: red;}
			#common .purchase {color: red;}
			#rare 
			{
				border-color: blue;
				background-image: url(rareskin.png);
			}
			#rare .title {color: blue;}
			#rare .purchase {color: blue;}
			#epic 
			{
				border-color: purple;
				background-image: url(epicskin.png);
			}
			#epic .title {color: purple;}
			#epic .purchase {color: purple;}
			.skinSelect
			{
				position: absolute;
				cursor: pointer;
			}
			.skinSelect:hover
			{
				text-decoration: underline;
			}
			.skinSelect img
			{
				height: 100%;
				position: absolute;
				right: 0;
				top: 0;
				image-rendering: pixelated;
			}
		</style>
    </head>
    <body>
		<div id="mainpage">
			<canvas id = "canvas" style="border:2px solid blue;" style="background-color: white;"></canvas>
			<button id="again" onclick="again()" onmouseover="againHover()" onmouseleave="againLeave()"><b>Play Again??</b></button>
			<p id="info">[p] to pause<br>[r] to start over<br>[o] to exit to start</p>
			<p id="score"></p>
			<p id="highscore"></p>
		</div>
        <div id="startpage">
			<img id="startImg" src="SnakeDodger.png"></img>
			<p id="play" onclick="playClick()">Play</p>
			<p id="surv" onclick="survClick()">Survival</p>
			<p id="tutor" onclick="tutorClick()">Tutorial</p>
			<p id="shop" onclick="shopClick()">Shop</p>
		</div>
		<div id="shoppage">
			<p id="back" onclick="backClick()">Back to Start Page</p>
			<p id="gold">10g</p>
			<div class="skinCrate" id="common">
				<p class="title">Random Common Skin</p>
				<p class="purchase" onclick="randomCommon()">Buy 20g</p>
			</div>
			<div class="skinCrate" id="rare">
				<p class="title">Random Rare Skin</p>
				<p class="purchase" onclick="randomRare()">Buy 100g</p>
			</div>
			<div class="skinCrate" id="epic">
				<p class="title">Random Epic Skin</p>
				<p class="purchase" onclick="randomEpic()">Buy 300g</p>
			</div>
			<div id="skinSelect">
				<p class="commonSelect skinSelect" id="dimyellow" onclick="setSkin('dimyellow',this)">Dim Yellow<img src="lock.png"></img></p>
				<p class="commonSelect skinSelect" id="yellow" onclick="setSkin('yellow',this)">Yellow<img src="lock.png"></img></p>
				<p class="commonSelect skinSelect" id="red" onclick="setSkin('red',this)">Red<img src="lock.png"></img></p>
				<p class="commonSelect skinSelect" id="gray" onclick="setSkin('gray',this)">Gray<img src="lock.png"></img></p>
				<p class="rareSelect skinSelect" id="yellowgreen" onclick="setSkin('yellowgreen',this)">Yellow-Green<img src="lock.png"></img></p>
				<p class="rareSelect skinSelect" id="blackwhite" onclick="setSkin('blackwhite',this)">Black-White<img src="lock.png"></img></p>
				<p class="rareSelect skinSelect" id="smallgrid" onclick="setSkin('smallgrid',this)">Small Grid<img src="lock.png"></img></p>
				<p class="epicSelect skinSelect" id="biggrid" onclick="setSkin('biggrid',this)">Big Grid<img src="lock.png"></img></p>
				<p class="epicSelect skinSelect" id="circle" onclick="setSkin('circle',this)">Circles<img src="lock.png"></img></p>
				<p class="epicSelect skinSelect" id="rainbow" onclick="setSkin('rainbow',this)">Rainbow<img src="lock.png"></img></p>
			</div>
		</div>
        <script>
			document.getElementById("startImg").style.width = Math.floor(30*window.innerWidth/100) + "px";
		
			document.getElementById("play").style.fontSize = Math.floor(10*window.innerHeight/100) + "px";
			document.getElementById("play").style.top = Math.floor(40*window.innerHeight/100) + "px";
			document.getElementById("play").style.left = Math.floor(44*window.innerWidth/100) + "px";
			
			document.getElementById("surv").style.fontSize = Math.floor(7*window.innerHeight/100) + "px";
			document.getElementById("surv").style.top = Math.floor(56*window.innerHeight/100) + "px";
			document.getElementById("surv").style.left = Math.floor(42*window.innerWidth/100) + "px";
			
			document.getElementById("tutor").style.fontSize = Math.floor(7*window.innerHeight/100) + "px";
			document.getElementById("tutor").style.top = Math.floor(69*window.innerHeight/100) + "px";
			document.getElementById("tutor").style.left = Math.floor(42*window.innerWidth/100) + "px";
			
			document.getElementById("shop").style.fontSize = Math.floor(7*window.innerHeight/100) + "px";
			document.getElementById("shop").style.top = Math.floor(80*window.innerHeight/100) + "px";
			document.getElementById("shop").style.left = Math.floor(46*window.innerWidth/100) + "px";
			
			var buySkins = document.getElementsByClassName("skinCrate");
			for(var i = 0;i<buySkins.length;i++)
			{
				buySkins[i].style.width = Math.floor(48*window.innerWidth/100) + "px";
				buySkins[i].style.height = Math.floor(30*window.innerHeight/100) + "px";
				buySkins[i].style.margin = Math.floor(2*window.innerHeight/100 - window.innerHeight/100) + "px";
				buySkins[i].style.borderWidth = Math.floor(window.innerHeight/200) + "px";
				buySkins[i].childNodes[1].style.fontSize = Math.floor(6*window.innerHeight/100) + "px";
				buySkins[i].childNodes[3].style.fontSize = Math.floor(8*window.innerHeight/100) + "px";
			}
			
			document.getElementById("back").style.fontSize = Math.floor(3*window.innerHeight/100) + "px";
			document.getElementById("back").style.width = Math.floor(30*window.innerHeight/100) + "px";
			document.getElementById("gold").style.fontSize = Math.floor(5*window.innerHeight/100) + "px";
			document.getElementById("common").style.top = Math.floor(4*window.innerHeight/100) + "px";
			document.getElementById("rare").style.top = Math.floor(35*window.innerHeight/100) + "px";
			document.getElementById("epic").style.top = Math.floor(66*window.innerHeight/100) + "px";
			
			var posIncrement = 4;
			var skinSelects = document.getElementsByClassName("skinSelect");
			for(var i = 0;i<skinSelects.length;i++)
			{
				skinSelects[i].style.fontSize = Math.floor(3*window.innerHeight/100) + "px";
				skinSelects[i].style.border = Math.floor(0.2*window.innerHeight/100) + "px solid red";
                if(0.2*window.innerHeight/100<1)
                {
                    skinSelects[i].style.border = "1px solid red";
                }
				skinSelects[i].style.width = Math.floor(40*window.innerWidth/100) + "px";
				skinSelects[i].style.height = Math.floor(8*window.innerHeight/100) + "px";
				skinSelects[i].style.top = Math.floor(posIncrement*window.innerHeight/100) + "px";
				skinSelects[i].style.right = Math.floor(1*window.innerHeight/100) + "px";
				posIncrement+=9;
			}
			
            document.getElementById("score").style.fontSize = Math.floor(window.innerHeight/22) + "px";
            document.getElementById("highscore").style.fontSize = Math.floor(window.innerHeight/28) - 6 + "px";
            document.getElementById("highscore").style.bottom = Math.floor(window.innerHeight/10) + 3 + "px";
			document.getElementById("info").style.fontSize = Math.floor(window.innerHeight/35) + "px";
			document.getElementById("info").style.bottom = Math.floor(window.innerHeight/3) + "px";
            
			var againw = Math.floor(2*window.innerWidth/15);
			var againh = Math.floor(window.innerHeight/7);
			document.getElementById("again").style.width = againw + "px";
			document.getElementById("again").style.height = againh + "px";
			document.getElementById("again").style.fontSize = 4*againh/15 + "px";
            
            document.getElementById("info").fontSize = Math.floor(9*window.innerHeight/100) + "px";
			
            
            var width = window.innerWidth - againw - Math.floor(2*window.innerWidth/100);
            var height = Math.floor(97*window.innerHeight/100);
            var squLen = Math.floor(height/40);
			width = squLen*Math.floor(width/squLen);
			height = squLen*Math.floor(height/squLen);
			var rnd = 1857;
			
            var canvas = document.getElementById("canvas");
            canvas.width = width;
            canvas.height = height;
            
            var context = canvas.getContext("2d");
            
            var verblockgrid;
            
            var setMode = "plainWhite";
            var canvInt;
            
            //declare all variables needed here instead of run()
            var snakePos;
            var score;
            var interval;
            var lost;
            var smiley;
			var wallBlockVar;
			var playMode;
			
			//shop
			if(!localStorage.gold)
			{
				localStorage.gold = 20;
			}
			var gold = localStorage.gold;
			document.getElementById("gold").innerHTML = gold + "g";
			//dimyellow yellow gray red
			//yellowgreen blackwhite smallgrid
			//rainbow circle biggrid
			if(!localStorage.ownedSkins)
			{
				localStorage.ownedSkins = JSON.stringify(["dimyellow"]);
			}
			if(!localStorage.skin)
			{
				localStorage.skin = "dimyellow";
			}
			var skin = localStorage.skin;
			document.getElementById(skin).style.textDecoration = "underline";
			var ownedSkin = JSON.parse(localStorage.ownedSkins);
			var skinInt = 0;
			var commonSkin = ["dimyellow","yellow","gray","red"];
			var rareSkin = ["yellowgreen","blackwhite","smallgrid"];
			var epicSkin = ["rainbow","circle","biggrid"];
			var unownedCommon = [];
			var unownedRare = [];
			var unownedEpic = [];
			for(var i = 0;i<commonSkin.length;i++)
			{
				if(!ownedSkin.includes(commonSkin[i]))
				{
					unownedCommon.push(commonSkin[i]);
				}
			}
			for(var i = 0;i<rareSkin.length;i++)
			{
				if(!ownedSkin.includes(rareSkin[i]))
				{
					unownedRare.push(rareSkin[i]);
				}
			}
			for(var i = 0;i<epicSkin.length;i++)
			{
				if(!ownedSkin.includes(epicSkin[i]))
				{
					unownedEpic.push(epicSkin[i]);
				}
			}
			for(var i = 0;i<ownedSkin.length;i++)
			{
				document.getElementById(ownedSkin[i]).childNodes[1].style.display = "none";
			}
			
            var playing = true;
            
            var direction;
            document.body.onkeydown = function(e)
            {
                var code = e.keyCode ? e.keyCode : e.which;
                //w = 87
                //up = 38
                if((code == 87||code == 38)&&direction!=4) direction = 1;
                //a = 65
                //left = 37
                if((code == 65||code ==37)&&direction!=3) direction = 2;
                //d = 68
                //right = 39
                if((code == 68||code == 39)&&direction!=2) direction = 3;
                //s = 83
                //down = 40
                if((code == 83||code == 40)&&direction!=1) direction = 4;
                //enter = 13
                if(code == 13&&lost) run();
                //p = 80
                if(code == 80&&lost) alert(localStorage.plays);
                if(code == 80&&!lost) pause();
				//r = 82
				if(code == 82)
				{
					if(confirm("Are you sure? This will erase all your progress."))
					{
						clearInterval(interval);
						localStorage.checkpoint = 0;
						run();
						score = 0;
						for(var j = ((width/squLen) - 1);j>=0;j--) verblockgrid[j].fill(0);
						for(var j = 41;j>=0;j--)
						{
							for(var i = ((width/squLen) - 1);i>=0;i--)
							{
								if(!ifOnSnake(i,j))
								{
									eraseBlock(i,j);
								}
							}
						}
					}
				}
				//o
				if(code == 79)
				{
					if(confirm("Are you sure? You'll lose your current run."))
					{
						location.reload();
					}
				}
            }
            
			function playClick()
			{
				document.getElementById("mainpage").style.display = "block";
				document.getElementById("startpage").style.display = "none";
				playMode = "campaign";
				run();
			}
			function survClick()
			{
				document.getElementById("mainpage").style.display = "block";
				document.getElementById("startpage").style.display = "none";
				playMode = "survival";
				run();
			}
			function tutorClick()
			{
				document.getElementById("mainpage").style.display = "block";
				document.getElementById("startpage").style.display = "none";
				playMode = "tutorial";
				run();
			}
            function shopClick()
			{
				document.getElementById("shoppage").style.display = "block";
				document.getElementById("startpage").style.display = "none";
			}
			function backClick()
			{
				document.getElementById("shoppage").style.display = "none";
				document.getElementById("startpage").style.display = "block";
			}
			function setSkin(newSkin,ele)
			{
				if(ownedSkin.includes(newSkin))
				{
					skin = newSkin;
					localStorage.skin = skin;
					for(var i = 0;i<skinSelects.length;i++)
					{
						skinSelects[i].style.textDecoration = "none";
					}
					ele.style.textDecoration = "underline";
				}
			}
			function randomCommon()
			{
				if(gold>=20&&unownedCommon.length>0)
				{
					if(confirm("Are you sure?"))
					{
						gold-=20;
						localStorage.gold = gold;
						var randomTemp = Math.floor(Math.random() * unownedCommon.length);
						ownedSkin.push(unownedCommon[randomTemp]);
						localStorage.ownedSkins = JSON.stringify(ownedSkin);
						alert("You unlocked " + unownedCommon[randomTemp]);
                        document.getElementById(unownedCommon[randomTemp]).childNodes[1].style.display = "none";
						document.getElementById("gold").innerHTML = gold + "g";
						unownedCommon.splice(randomTemp,1);
					}
				}
				else if(gold<20) alert("Purchase failed. You do not have enough gold.");
				else alert("Purchase failed. You already have all the common skins.");
			}
			function randomRare()
			{
				if(gold>=100&&unownedRare.length>0)
				{
					if(confirm("Are you sure?"))
					{
						gold-=100;
						localStorage.gold = gold;
						var randomTemp = Math.floor(Math.random() * unownedRare.length);
						ownedSkin.push(unownedRare[randomTemp]);
						localStorage.ownedSkins = JSON.stringify(ownedSkin);
						alert("You unlocked " + unownedRare[randomTemp]);
                        document.getElementById(unownedRare[randomTemp]).childNodes[1].style.display = "none";
						document.getElementById("gold").innerHTML = gold + "g";
						unownedRare.splice(randomTemp,1);
					}
				}
				else if(gold<100) alert("Purchase failed. You do not have enough gold.");
				else alert("Purchase failed. You already have all the rare skins.");
			}
			function randomEpic()
			{
				if(gold>=300&&unownedEpic.length>0)
				{
					if(confirm("Are you sure?"))
					{
						gold-=300;
						localStorage.gold = gold;
						var randomTemp = Math.floor(Math.random() * unownedEpic.length);
						ownedSkin.push(unownedEpic[randomTemp]);
						localStorage.ownedSkins = JSON.stringify(ownedSkin);
						alert("You unlocked " + unownedEpic[randomTemp]);
                        document.getElementById(unownedEpic[randomTemp]).childNodes[1].style.display = "none";
						document.getElementById("gold").innerHTML = gold + "g";
						unownedEpic.splice(randomTemp,1);
					}
				}
				else if(gold<300) alert("Purchase failed. You do not have enough gold.");
				else alert("Purchase failed. You already have all the epic skins.");
			}
            function run()
            {
                if(isNaN(localStorage.plays))
                {
                    localStorage.plays = 1;
                }
                else localStorage.plays++;
                
                document.getElementById("again").style.visibility = "hidden";
                context.clearRect(0,0,width,height);
                lost = false;

                verblockgrid = new Array(width/squLen);
                for(var i = 0;i<(width/squLen);i++)
                {
                    verblockgrid[i] = new Array(40);    
                }
				
				
                plainWhite("canvas");
				clearInterval(canvInt);

                snakePos = [{x: 1, y: (height/squLen - 2)},{x: 2, y: (height/squLen - 2)},{x: 3, y: (height/squLen - 2)},{x: 4, y: (height/squLen - 2)},{x: 5, y: (height/squLen - 2)}];
                for(var i = 0; i<5;i++)
                {
                    drawSnake(snakePos[i].x,snakePos[i].y);    
                }
				
				score = 0;
				if(playMode=="campaign")
				{
					if(!isNaN(localStorage.checkpoint))
					{
						if(localStorage.checkpoint > 0)
						{
							score = localStorage.checkpoint - 40;
						}
					}
				}
				wallBlockVar = 0;
                direction = 3;
                
                //variables for random dropping of figures
                smiley = Math.floor(Math.random()*(width/squLen - 9));
                if(score>1250&&score<1630)
                {
                    document.getElementById("info").innerHTML = "Demons?"
                }
                
                //interval
                interval = setInterval(function()
                {
					
                    runInter();
                },110);
            }
            
            //functions
            function runInter()
            {
				if(!lost&&playMode=="campaign")
				{
					score++;
					if(isNaN(localStorage.highscore))
					{
						localStorage.highscore = 0;
					}
					else
					{
						if(score>localStorage.highscore)
						{
							localStorage.highscore = score;
						}
					}
					document.getElementById("score").innerHTML = "Score: " + score;
					document.getElementById("highscore").innerHTML = "High Score: " + localStorage.highscore;

					blockFall();

					//out of bounds
					if(snakePos[4].x < 0||snakePos[4].x >= width/squLen||snakePos[4].y < 0||snakePos[4].y >= height/squLen)
					{
						lose("You bump into the wall and die.");
					}
				}
				if(!lost&&playMode=="survival")
				{
					score++;
					if(isNaN(localStorage.highscore2))
					{
						localStorage.highscore2 = 0;
					}
					else
					{
						if(score>localStorage.highscore2)
						{
							localStorage.highscore2 = score;
						}
					}
					document.getElementById("score").innerHTML = "Score: " + score;
					document.getElementById("highscore").innerHTML = "High Score: " + localStorage.highscore2;

					blockFall();

					//out of bounds
					if(snakePos[4].x < 0||snakePos[4].x >= width/squLen||snakePos[4].y < 0||snakePos[4].y >= height/squLen)
					{
						lose("You bump into the wall and die.");
					}
				}
				if(!lost&&playMode=="tutorial")
				{
					score++;
					if(isNaN(localStorage.highscore3))
					{
						localStorage.highscore3 = 0;
					}
					else
					{
						if(score>localStorage.highscore3)
						{
							localStorage.highscore3 = score;
						}
					}
					document.getElementById("score").innerHTML = "Score: " + score;
					document.getElementById("highscore").innerHTML = "High Score: " + localStorage.highscore3;

					blockFall();

					//out of bounds
					if(snakePos[4].x < 0||snakePos[4].x >= width/squLen||snakePos[4].y < 0||snakePos[4].y >= height/squLen)
					{
						lose("You bump into the wall and die.");
					}
				}


                if(playMode == "campaign")
                {
                    //Smiley
					if(score<400)
					{
                        document.getElementById("info").innerHTML = "[p] to pause<br>[r] to start over<br>[o] to exit to start<br>checkpoint every<br>200 score";
					}
					if(score == 1)
					{
						plainWhite("canvas");
						clearInterval(canvInt);
					}
                    else if(score == 24)
                    {
                        dropBlocks([smiley+2,smiley+3,smiley+4,smiley+5,smiley+6],1,"red");
                    }
                    else if(score == 25)
                    {
                        dropBlocks([smiley+1,smiley+7],1,"red");
                    }
                    else if(score == 26||score == 27)
                    {
                        dropBlocks([smiley,smiley+8],1,"red");
                    }
                    else if(score == 28)
                    {
                        dropBlocks([smiley,smiley+1,smiley+2,smiley+3,smiley+4,smiley+5,smiley+6,smiley+7,smiley+8],1,"red");
                    }
                    else if(score == 30||score == 31)
                    {
                        dropBlocks([smiley+1,smiley+2,smiley+6,smiley+7],1,"red");
                    }
                    //DLStudios
                    else if(score == 100)
                    {
						plainBlack("canvas");
                        dropBlocks([7,8,9,13,14,15,16,17,19,20,21,22,27,28,32,33,35,38,39,40,41,44,45,46,50,51,52,55,56,57,58],1,"red");
                    }
                    else if(score == 101)
                    {
                        dropBlocks([7,10,13,23,26,29,31,34,35,37,41,45,49,53,59],1,"red");
                    }
                    else if(score == 102)
                    {
                        dropBlocks([7,11,13,23,26,31,35,37,41,45,49,53,56,57,58],1,"red");
                    }
                    else if(score == 103)
                    {
                        dropBlocks([7,11,13,20,21,22,26,31,35,37,40,41,45,49,53,55],1,"red");
                    }
                    else if(score == 104)
                    {
                        dropBlocks([7,11,13,19,25,26,27,31,35,38,39,41,44,45,50,51,52,56,57,58],1,"red");
                    }
                    else if(score == 105)
                    {
                        dropBlocks([7,10,13,19,26,41],1,"red");
                    }
                    else if(score == 106)
                    {
                        dropBlocks([7,8,9,13,20,21,22,23,26,41,45],1,"red");
                    }
                    //Wall
                    else if(score == 200)
                    {
						plainWhite("canvas");
                        wall();
                    }
					else if(score>=300&&score<400&&setMode!="changeColor")
					{
						changeColor("canvas");
					}
                    else if(score == 400)
                    {
                        document.getElementById("info").innerHTML = "Congrats! You <br>finished the tutorial";
						plainWhite("canvas");
                        wall();
                    }
                    else if(score == 500)
                    {
                        document.getElementById("info").innerHTML = "[p] to pause<br>[r] to start over<br>[o] to exit to start";
                    }
					else if(score == 600)
					{
						changeColor("canvas");
						for(i = 0;i<Math.floor(width/squLen-2);i+=2)
						{
							dropBlock(i,1,"red");
						}
					}
					else if(score == 630||score==660||score==690)
					{
						for(i = 0;i<Math.floor(width/squLen-2);i+=2)
						{
							dropBlock(i,1,"red");
						}
					}
					else if(score == 700)
					{
						plainBlack("canvas");
					}
                    else if(score == 780)
                    {
						document.getElementById("info").innerHTML = "Beware!!!";
                    }
					else if(score == 810||score == 830||score == 850)
					{
						plainWhite("canvas");
					}
                    else if(score == 800||score == 820||score == 840)
					{
						plainBlack("canvas");
						for(i = 0;i<Math.floor(width/squLen-2);i+=2)
						{
							dropBlock(i,1,"red");
						}
					}
                    else if(score == 850)
                    {
						document.getElementById("info").innerHTML = "[p] to pause<br>[r] to start over<br>[o] to exit to start";
                    }
					else if(score == 900)
					{
						for(i = 0;i<Math.floor(width/squLen);i++)
						{
							dropBlock(i,4,"green");
						}
					}
					else if(score == 1000)
					{
                        changeColor("canvas");
						for(i = 0;i<Math.floor(width/squLen);i++)
						{
							dropBlock(i,4,"green");
						}
					}
					else if(score == 1100)
					{
                        plainWhite("canvas");
						for(i = 0;i<Math.floor(width/squLen);i++)
						{
							dropBlock(i,4,"green");
						}
					}
					else if(score == 1161)
					{
						document.getElementById("info").innerHTML = "[p] to pause<br>[r] to start over<br>[o] to exit to start";
					}
					else if(score == 1200)
					{
						document.getElementById("info").innerHTML = "A short break";
					}
                    else if(score == 1250)
                    {
                        document.getElementById("info").innerHTML = "Demons?";
                    }
                    else if(score == 1630)
                    {
                        document.getElementById("info").innerHTML = "Arg! I am the<br>boss. I will<br>make you suffer!";
                        laserVer(11,10);
                        laserHor(11,10);
                        randomSpawn(8,"pink");
						
                    }
                    else if(score == 1640||score == 1650||score == 1660||score == 1670)
                    {
                        laserVer(11,10);
                        laserHor(11,10);
                    }
                    else if(score == 1690)
                    {
                        plainBlack("canvas");
                        wall();
                        demon();
                        demon();
                    }
                    else if(score == 1705)
                    {
                        plainWhite("canvas");
                        document.getElementById("info").innerHTML = "Still alive?<br>You'll never get<br>past this!";
                    }
                    else if(score == 1715)
                    {
                        box(6,8);
                    }
                    else if(score == 1724)
                    {
                        box(5,8);
                    }
                    else if(score == 1733)
                    {
                        box(4,8);
                        randomSpawn(8,"pink");
                    }
                    else if(score == 1740||score == 1756||score == 1772||score == 1788)
                    {
                        laserVer(8,10);
                    }
                    else if(score == 1748||score == 1764||score == 1780||score == 1796)
                    {
                        laserHor(8,10);
                    }
                    else if(score==1800)
                    {
                        document.getElementById("info").innerHTML = "What? Lasers<br>down? Then I'll<br>kill you myself!";
                    }
                    else if(score == 1810)
                    {
                        for(var i = 0;i<10;i++)
                        {
                            demon();
                        }
                        randomDrop(5,"black");
                        randomDrop(5,"black");
                    }
                    else if(score == 1830)
                    {
                        randomSpawn(8,"pink");
                    }
                    else if(score >= 1860&&score <= 1875)
                    {
                        spawnBlock(snakePos[4].x,snakePos[4].y-5,1,"red");
                    }
                    else if(score == 1880)
                    {
                        wall();
                        wall();
                        wall();
                        randomDrop(5,"black");
                        randomDrop(5,"black");
                        randomDrop(5,"black");
                        randomDrop(5,"black");
                        document.getElementById("info").innerHTML = "Enjoying it<br>so far? Good!";
                    }
					else if(score==1920)
					{
						randomSpawn(8,"pink");
					}
					else if(score == 1941)
					{
						 document.getElementById("info").innerHTML = "Fine Then. I'll<br>do it manually";
						 changeColor("canvas");
					}
					else if(score == 1950)
					{
						dlsCoin();
						spawnBlock(0,20,8,"pink");
						spawnBlock(width/squLen - 1,20,8,"pink");
						spawnBlock(Math.floor(width/squLen/2),0,8,"pink");
						spawnBlock(Math.floor(width/squLen/2),40,8,"pink");
					}
					else if(score == 1960)
					{
						document.getElementById("info").innerHTML = "It's getting too<br>close! Slow it<br>down! Empty the<br>reserves! Now!";
					}
					else if(score > 1960&&score<=1970)
					{
                        spawnBlock(snakePos[4].x,snakePos[4].y-5,1,"red");
					}
					else if(score==1971||score==1975||score==1979||score==1983||score==1987)
					{
						laserHor(7,4);
						plainWhite("canvas");
					}
					else if(score==1973||score==1977||score==1981||score==1985)
					{
						laserVer(7,4);
						plainBlack("canvas");
					}
					else if(score == 1995)
					{
						document.getElementById("info").innerHTML = "Nooo! Prepare<br>my ship. We're<br>escaping! Run!";
					}
					else if(score==1991||score==1995||score==1999)
					{
						laserHor(7,4);
					}
					else if(score==1993||score==1997)
					{
						laserVer(7,4);
					}
					else if(score == 2000)
					{
						wall();
						document.getElementById("info").innerHTML = "The boss ship<br>leaves...";
					}
					else if(score == 2040)
					{
						document.getElementById("info").innerHTML = "You have beat the<br> boss! You got 300g.<br>Presented by:<br>DLStudios<br>Jia Xuan Cheng";
						gold+=300;
						localStorage.gold = gold;						
						document.getElementById("gold").innerHTML = gold+"g";
						document.getElementById("info").style.color = "green";
					}
					else if(score == 2041)
                    {
						plainBlack("canvas");
                        dropBlocks([7,8,9,13,14,15,16,17,19,20,21,22,27,28,32,33,35,38,39,40,41,44,45,46,50,51,52,55,56,57,58],1,"red");
                    }
                    else if(score == 2042)
                    {
                        dropBlocks([7,10,13,23,26,29,31,34,35,37,41,45,49,53,59],1,"red");
                    }
                    else if(score == 2043)
                    {
                        dropBlocks([7,11,13,23,26,31,35,37,41,45,49,53,56,57,58],1,"red");
                    }
                    else if(score == 2044)
                    {
                        dropBlocks([7,11,13,20,21,22,26,31,35,37,40,41,45,49,53,55],1,"red");
                    }
                    else if(score == 2045)
                    {
                        dropBlocks([7,11,13,19,25,26,27,31,35,38,39,41,44,45,50,51,52,56,57,58],1,"red");
                    }
                    else if(score == 2046)
                    {
                        dropBlocks([7,10,13,19,26,41],1,"red");
                    }
                    else if(score == 2047)
                    {
                        dropBlocks([7,8,9,13,20,21,22,23,26,41,45],1,"red");
                    }
					
					
                    //List of blanks
                    //wall #1
                    if(ScoreWithin(185,215,[200])) {}
                    //wall #2
                    else if(ScoreWithin(385,415,[400])) {}
                    else if(ScoreWithin(95,110,[])) {}
                    else if(score<300)
                    {
                        for(var i = 0;i<=(Math.floor(score/150));i++)
                        {
                            randomDrop(1,"red");
                        }
						if(random()<0.05)
						{
							randomDrop(10,"yellow");
						}
                    }
                    else if(score>=300&&score<1200)
                    {
                        randomDrop(1,"red");
						if(score%2 == 0)
						{
							randomSpawn(1,"red");
						}
                        if(score%2 == 0)
                        {
                            for(var i = 0;i<Math.floor(score/200) - 1;i++)
                            {
                                randomDrop(1,"red");
                            }
                        }
                        if(score%8 == 1)
                        {
                            for(var i = 0;i<Math.floor(score/200) - 1;i++)
                            {
                                randomDrop(2,"blue");
                            } 
                            if(Math.random()<0.1) randomDrop(5,"black");
                        }
						if(random()<0.04)
						{
							randomDrop(3,"purple");
						}
						if(random()<0.02)
						{
							randomDropWall(4,"green",4);
						}
						if(random()<0.1)
						{
							randomDrop(10,"yellow");
						}
                    }
					else if(score>=1200&&score<1250)
					{
				        randomDrop(1,"red");
						if(random()<0.05)
						{
							randomDrop(10,"yellow");
						}
					}
                    else if(score>=1250&&score<1600)
                    {
                        if(Math.random()<0.06) demon();
                        if(Math.random()<0.1) randomDrop(5,"black");
                        for(var i = 0;i<Math.floor(score/200) - 4;i++)
                        {
                            randomDrop(1,"red");
                        }
						if(random()<0.1)
						{
							randomDrop(10,"yellow");
						}
                    }
					else if(score>=2040&&score<=2240)
					{
						randomDrop(10,"yellow");
						randomDrop(10,"yellow");
					}

					

                    //moving snake

					
                }
				if(playMode == "survival")
				{
					if(score == 1)
					{
						document.getElementById("info").innerHTML = "[p] to pause<br>[r] to start over<br>[o] to exit to start<br>Survive";
					}
					if(score<2000)
					{
						for(var i = 0;i<=(Math.floor(score/150));i++)
						{
							randomDrop(1,"red");
						}
						for(var i = 0;i<(Math.floor(score/250));i++)
						{
							if(random()<0.1)
							{
								randomDrop(2,"blue");
							}
						}
						if(random()<0.05)
						{
							randomDrop(10,"yellow");
						}
					}
					if(score>400)
					{
						if(random()<0.015)
						{
							randomDrop(3,"purple");
						}
						if(random()<0.01)
						{
							randomDropWall(4,"green",3);
						}
					}
				}
				if(playMode == "tutorial")
				{
					if(score == 1)
					{
						document.getElementById("info").innerHTML = "WASD or arrows to<br>move. Dodge the <span style='color:red;'>red</span><br> blocks.[p] to pause.<br>[enter] to play again<br>or press the button.";
					}
					if(score<300)
					{
						for(var i = 0;i<=(Math.floor(score/150));i++)
						{
							if(random()<0.5)
							{
								randomDrop(1,"red");
							}
						}
					}
					if(score>=300&&score<600)
					{
						for(var i = 0;i<=(Math.floor(score/150))-1;i++)
						{
							if(random()<0.5)
							{
								randomDrop(1,"red");
							}
						}
						if(random()<0.1)
						{
							randomDrop(2,"blue");
						}
						if(random()<0.05)
						{
							randomDrop(3,"purple");
						}
						if(random()<0.05)
						{
							randomDrop(4,"green");
						}
					}
					if(score == 300)
					{
						document.getElementById("info").innerHTML = "New blocks! Dodge<br>all of them but the <br><span style='color:purple;'>purple</span> block, which <br>does something else.";
					}
					if(score==600)
					{
						document.getElementById("info").innerHTML = "You finished the<br>tutorial! Head over<br>to play mode or<br>survival now. [o] to<br>exit to start page.<br>[r] to restart.";
					}
				}
				if(!lost)
				{
					eraseBlock(snakePos[0].x,snakePos[0].y)
					snakeMove();
					if(direction == 1)
					{
						(snakePos[4].y)--;
					}
					if(direction == 2)
					{
						(snakePos[4].x)--;
					}
					if(direction == 3)
					{
						(snakePos[4].x)++;
					}
					if(direction == 4)
					{
						(snakePos[4].y)++;
					}
					drawSnake(snakePos[4].x,snakePos[4].y);
					//moving snake
				}
            }
            function drawSnake(x,y)
            {
				context.beginPath();
				skinInt++;
				//common
				if(skin == "dimyellow")
				{
					context.fillStyle = "#C2A93A";
				}
				if(skin == "yellow")
				{
					context.fillStyle = "yellow";
				}
				if(skin == "gray")
				{
					context.fillStyle = "gray";
				}
				if(skin == "red")
				{
					context.fillStyle = "red";
				}
				//rare
				if(skin == "yellowgreen")
				{
					if(skinInt%2 == 0)
					{
						context.fillStyle = "yellow";
					}
					if(skinInt%2 == 1)
					{
						context.fillStyle = "green";
					}
				}
				if(skin == "blackwhite")
				{
					if(skinInt%2 == 0)
					{
						context.fillStyle = "black";
					}
					if(skinInt%2 == 1)
					{
						context.fillStyle = "white";
					}
				}
				if(skin == "smallgrid")
				{
					context.fillStyle = "yellow";
					context.fillRect((squLen*x+Math.floor(squLen/8)),(squLen*y+Math.floor(squLen/8)),squLen-2*Math.floor(squLen/8),squLen-2*Math.floor(squLen/8));
				}
				//epic/legendary
				if(skin == "biggrid")
				{
					context.fillStyle = "yellow";
					context.fillRect((squLen*x+Math.floor(22*squLen/100)),(squLen*y+Math.floor(22*squLen/100)),squLen-2*Math.floor(22*squLen/100),squLen-2*Math.floor(22*squLen/100));
				}
				if(skin == "circle")
				{
					context.beginPath();
					context.fillStyle = "yellow";
					context.arc(squLen*x+squLen/2,squLen*y+squLen/2,squLen/2,0,2*Math.PI);
					context.fill();				
				}
				if(skin == "rainbow")
				{
					if(skinInt%7 == 6)
					{
						context.fillStyle = "red";
					}
					if(skinInt%7 == 5)
					{
						context.fillStyle = "orange";
					}
					if(skinInt%7 == 4)
					{
						context.fillStyle = "yellow";
					}
					if(skinInt%7 == 3)
					{
						context.fillStyle = "green";
					}
					if(skinInt%7 == 2)
					{
						context.fillStyle = "cyan";
					}
					if(skinInt%7 == 1)
					{
						context.fillStyle = "blue";
					}
					if(skinInt%7 == 0)
					{
						context.fillStyle = "purple";
					}
				}
				
				if(skin!="smallgrid"&&skin!="biggrid"&&skin!="circle")
				{
					context.fillRect((squLen*x),(squLen*y),squLen,squLen);
				}
            }
            function drawBoulder(x,y,color)
            {
				context.beginPath();
                context.fillStyle = color;
                context.fillRect((squLen*x),(squLen*y),squLen,squLen);
            }
            function eraseBlock(x,y)
            {
				context.beginPath();
                context.clearRect((squLen*x),(squLen*y),squLen,squLen);
            }
            function snakeMove()
            {
                snakePos[0].x = snakePos[1].x;
                snakePos[0].y = snakePos[1].y;
                
                snakePos[1].x = snakePos[2].x;
                snakePos[1].y = snakePos[2].y;
                
                snakePos[2].x = snakePos[3].x;
                snakePos[2].y = snakePos[3].y;
                
                snakePos[3].x = snakePos[4].x;
                snakePos[3].y = snakePos[4].y;
            }
            
            function ifOnSnake(x,y)
            {
                for(var i = 0;i<5;i++)
                {
                    if(snakePos[i].x == x&&snakePos[i].y == y)
                    {
                        return true;
                    }
                }
                return false;
            }
            
            function blockFall()
            {
                var alertLost = false;
                for(var j = 41;j>=0;j--)
                {
                    for(var i = ((width/squLen) - 1);i>=0;i--)
                    {
                        if((verblockgrid[i][j] == 1||verblockgrid[i][j] == 2||verblockgrid[i][j] == 4||verblockgrid[i][j] == 7||verblockgrid[i][j] == 8||verblockgrid[i][j] == 9)&&ifOnSnake(i,j)&&!alertLost)
                        {
                            lose("A block crashes on to you and you die.");
                            alertLost = true;
                            return;
                        }
                        if(verblockgrid[i][j] == 5&&(ifOnSnake(i,j)||ifOnSnake(i,j-1))&&!alertLost)
                        {
                            lose("A block crashes on to you and you die.");
                            alertLost = true;
                            return;
                        }
                        if(verblockgrid[i][j] == 6&&(ifOnSnake(i,j)||ifOnSnake(i,j+1))&&!alertLost)
                        {
                            lose("A block crashes on to you and you die.");
                            alertLost = true;
                            return;
                        }
						if(verblockgrid[i][j]==3&&ifOnSnake(i,j)&&!alertLost)
						{
							for(var j = ((width/squLen) - 1);j>=0;j--) verblockgrid[j].fill(0);
							for(var j = 41;j>=0;j--)
							{
								for(var i = ((width/squLen) - 1);i>=0;i--)
								{
									if(!ifOnSnake(i,j))
									{
										eraseBlock(i,j);
									}
								}
							}
						}
						if((verblockgrid[i][j]==10||verblockgrid[i][j]==11)&&ifOnSnake(i,j)&&!alertLost)
						{
							gold++;
							localStorage.gold = gold;
							document.getElementById("gold").innerHTML = gold+"g";
							verblockgrid[i][j]=0;
						}
                    }
                }
				
				wallBlockVar++;
                for(var j = 41;j>=0;j--)
                {
                    for(var i = ((width/squLen) - 1);i>=0;i--)
                    {
						if(verblockgrid[i][j] == 4)
						{
							Fall4(i,j);
						}
                        if(verblockgrid[i][j] == 1)
                        {
                            Fall1(i,j); 
                        }
                        if(verblockgrid[i][j] == 2)
                        {
                            Fall2(i,j);
                        }
						if(verblockgrid[i][j] == 3)
						{
							Fall3(i,j);
						}
                        if(verblockgrid[i][j] == 5)
                        {
                            Fall5(i,j);
                        }
                        if(verblockgrid[i][j] == 8)
                        {
                            Fall8(i,j);
                        }
                        if(verblockgrid[i][j] == 9)
                        {
                            Fall9(i,j);
                        }
						if(verblockgrid[i][j] == 10)
                        {
                            Fall10(i,j);
                        }
                    }
                }
                for(var j = 0;j<=41;j++)
                {
                    for(var i = ((width/squLen) - 1);i>=0;i--)
                    {
                        if(verblockgrid[i][j] == 6) Fall6(i,j);
                    }
                }
            }
            function Fall1(i,j)
            {
                eraseBlock(i,j);
                verblockgrid[i][j] = 0;
                if(j!=41&&verblockgrid[i][j+1]!=4&&verblockgrid[i][j+1]!=6)
                {
                    verblockgrid[i][j+1] = 1;
                    drawBoulder(i,j+1,"red");
                }
            }
            function Fall2(i,j)
            {
                eraseBlock(i,j);
                verblockgrid[i][j] = 0;
                if(j!=41)
                {
                    var a = random()
                    if(a < 0.5&&i>=1&&verblockgrid[i-1][j+1]!=4&&verblockgrid[i-1][j+1]!=6)
                    {
                        verblockgrid[i-1][j+1] = 2;
                        drawBoulder(i-1,j+1,"blue");
                    }
                    if(a > 0.5&&i<40&&verblockgrid[i+1][j+1]!=4&&verblockgrid[i+1][j+1]!=6)
                    {
                        verblockgrid[i+1][j+1] = 2;
                        drawBoulder(i+1,j+1,"blue");
                    }
                }
            }
			function Fall3(i,j)
			{
				eraseBlock(i,j);
				verblockgrid[i][j] = 0;
				if(j!=41&&verblockgrid[i][j+1]!=4&&verblockgrid[i][j+1]!=6)
				{
					verblockgrid[i][j+1] = 3;
                    drawBoulder(i,j+1,"purple");
				}
			}
            function Fall4(i,j)
			{
				if(wallBlockVar%4 == 1)
				{
					eraseBlock(i,j);
					verblockgrid[i][j] = 0;
					if(j!=41&&verblockgrid[i][j+1]!=6)
					{
						verblockgrid[i][j+1] = 4;
						drawBoulder(i,j+1,"green");
					}
				}
			}
            function Fall5(i,j)
            {
                eraseBlock(i,j);
                eraseBlock(i,j+1);
				verblockgrid[i][j] = 0;
                verblockgrid[i][j+1] = 0;
				if(j<39)
				{
					verblockgrid[i][j+2] = 5;
                    drawBoulder(i,j+2,"black");
				}
                else spawnBlock(i,40,6,"black");
            }
            function Fall6(i,j)
            {
                eraseBlock(i,j);
                eraseBlock(i,j-1);
				verblockgrid[i][j] = 0;
                verblockgrid[i][j-1] = 0;
				if(j>=0)
				{
					verblockgrid[i][j-2] = 6;
                    drawBoulder(i,j-2,"black");
				}
            }
            //No fall7, block #7 doesn't move
            function Fall8(i,j)
            {
                var newx = snakePos[2].x - i;
                var newy = j - snakePos[2].y;
                eraseBlock(i,j);
				verblockgrid[i][j] = 0;
                //right
                if(newx>=newy&&newx>=-newy&&verblockgrid[i+1][j]!=6)
                {
                    verblockgrid[i+1][j] = 9;
					drawBoulder(i+1,j,"pink");
                }
                //down
                if(newx>=newy&&newx<-newy&&verblockgrid[i][j+1]!=6)
                {
                    verblockgrid[i][j+1] = 9;
					drawBoulder(i,j+1,"pink");
                }
                //left
                if(newx<newy&&newx<-newy&&verblockgrid[i]-1[j]!=6)
                {
                    verblockgrid[i-1][j] = 9;
					drawBoulder(i-1,j,"pink");
                }
                //up
                if(newx<newy&&newx>=-newy&&verblockgrid[i][j-1]!=6)
                {
                    verblockgrid[i][j-1] = 9;
					drawBoulder(i,j-1,"pink");
                }
            }
            function Fall9(i,j)
            {
                if(wallBlockVar%3==0)
                {
                    verblockgrid[i][j] = 8;
                }
            }
			function Fall10(i,j)
            {
                eraseBlock(i,j);
                verblockgrid[i][j] = 0;
                if(j!=41&&verblockgrid[i][j+1]!=4&&verblockgrid[i][j+1]!=6)
                {
                    verblockgrid[i][j+1] = 10;
                    drawBoulder(i,j+1,"yellow");
                }
            }
            function dropBlock(col,val,color)
            {
                verblockgrid[col][0] = val;
                drawBoulder(col,0,color);
            }
			function dropBlocks(array,val,color)
			{
				for(var i = 0;i<array.length;i++)
				{
					dropBlock(array[i],val,color);
				}
			}
            function randomDrop(val,color)
            {
                var x = Math.floor(Math.random()*(width/squLen));
                dropBlock(x,val,color);
            }
			function randomDropWall(val, color, length)
			{
				var x = Math.floor(Math.random()*(width/squLen - length + 1));
				for(i = 0;i<length;i++)
				{
					dropBlock(x+i,val,color);
				}
			}
            
            function spawnBlock(x,y,val,color)
			{
				if(verblockgrid[x][y] != 4)
				{
					verblockgrid[x][y] = val;
					drawBoulder(x,y,color);
				}
			}
			function randomSpawn(val,color)
			{
				var x = Math.floor(Math.random()*(width/squLen));
				var y = Math.floor(Math.random()*(height/squLen));
				spawnBlock(x,y,val,color);
			}
            
			
            function lose(msg)
            {
				lost = true;
                alert(msg);
				if(isNaN(localStorage.checkpoint))
				{
					localStorage.checkpoint = 0;
				}
				if(score - (score%200) > localStorage.checkpoint)
				{
					localStorage.checkpoint = score - (score%200);
				}
                if(localStorage.checkpoint>1600)
                {
                    localStorage.checkpoint = 1600;
                }
                setTimeout(function()
				{
					clearInterval(interval);
				},10);
                document.getElementById("again").style.visibility = "visible";
                
            }
			function again()
			{
				run();
			}
			function againHover()
			{
				document.getElementById("again").style.color = "cyan";
				document.getElementById("again").style.backgroundColor = "orange";
			}
			function againLeave()
			{
				document.getElementById("again").style.color = "orange";
				document.getElementById("again").style.backgroundColor = "cyan";
			}
            
            function isScore(arr)
            {
                for(var i = 0;i<arr.length;i++)
                {
                    if(score == arr[i]) return true;
                }
                return false;
            }
            function ScoreWithin(min,max,arr)
            {
                if(score>=min&&score<=max&&!isScore(arr))
                {
                    return true;
                }
                return false;
            }
			function random()
			{
				rnd = (rnd * 1719 + 1) & 0xffff;
				return ((rnd%100)/100);
			}
            
            
            //shapes
            function wall()
            {
                var hole1 = Math.floor(Math.random()*(width/squLen)/4);
                var hole2 = Math.floor(Math.random()*(width/squLen)/4) + Math.floor((width/squLen)/4);
                var hole3 = Math.floor(Math.random()*(width/squLen)/4) + 2*Math.floor((width/squLen)/4);
                var hole4 = Math.floor(Math.random()*(width/squLen)/4) + 3*Math.floor((width/squLen)/4);
                for(var i = 0;i<width/squLen;i++)
                {
                    if(i != hole1&&i != hole1 + 1&&i != hole2&&i != hole2 + 1&&i != hole3&&i != hole3 + 1&&i != hole4&&i != hole4 - 1) dropBlock(i,1,"red");
                }
            }
            function demon()
            {
                var sp = Math.floor(Math.random() * (width/squLen - 15));
                var startscore = score;
                var demonInt = setInterval(function(){
                    if(lost) clearInterval(demonInt);
                    if(score == startscore+18) 
                    {
                        dropBlocks([sp, sp+14],1,"red");
                        clearInterval(demonInt);
                    }
                    if(score == startscore+17||score == startscore+16||score == startscore+15) dropBlocks([sp, sp+1, sp+13,sp+14],1,"red");
                    if(score == startscore+14) dropBlocks([sp, sp+1, sp+2, sp+12, sp+13,sp+14],1,"red");
                    //tip of head
                    if(score == startscore+13) dropBlocks([sp,sp+1,sp+2,sp+3,sp+6,sp+7,sp+8,sp+11,sp+12,sp+13,sp+14],1,"red");
                    if(score == startscore+12) dropBlocks([sp, sp+1,sp+2,sp+3,sp+4,sp+5,sp+9,sp+10,sp+11,sp+12, sp+13,sp+14],1,"red");
                    //eyebrows
                    if(score == startscore+11) dropBlocks([sp+1, sp+2,sp+3,sp+11,sp+12,sp+13],1,"red");
                    if(score == startscore+10) dropBlocks([sp+2, sp+4,sp+5,sp+9,sp+10,sp+12],1,"red");
                    if(score == startscore+9) dropBlocks([sp+2, sp+5,sp+6,sp+7,sp+8,sp+9,sp+12],1,"red");
                    if(score == startscore+8) dropBlocks([sp+1,sp+13],1,"red");
                    //eyes
                    if(score == startscore+7) dropBlocks([sp+1,sp+4,sp+5,sp+8,sp+9,sp+13],1,"red");
                    if(score == startscore+6) dropBlocks([sp+1,sp+13],1,"red");
                    if(score == startscore+5) dropBlocks([sp+2, sp+5,sp+6,sp+7,sp+8,sp+9,sp+12],1,"red");
                    //mouth center
                    if(score == startscore+4) dropBlocks([sp+2, sp+5,sp+9,sp+12],1,"red");
                    if(score == startscore+3) dropBlocks([sp+3, sp+6,sp+7,sp+8,sp+11],1,"red");
                    if(score == startscore+2) dropBlocks([sp+4,sp+5,sp+9,sp+10],1,"red");
                    if(score == startscore+1) dropBlocks([sp+6,sp+7,sp+8],1,"red");
                },110);
            }
            function laserVer(time1,time2)
            {
                var where = snakePos[4].x;
                spawnBlock(where,0,7,"red");
                spawnBlock(where,1,7,"red");
                spawnBlock(where,2,7,"red");
                spawnBlock(where,37,7,"red");
                spawnBlock(where,38,7,"red");
                spawnBlock(where,39,7,"red");
                var startscore = score;
                var int3 = setInterval(function()
                {
					if(lost)
					{
						clearInterval(int3);
					}
                    if(score == startscore + time1)
                    {
                        for(var i = 3;i<38;i++)
                        {
                            spawnBlock(where,i,7,"red");
                        }
                        for(var i = 0;i<41;i++)
                        {
                            if(ifOnSnake(where,i))
                            {
                                lose("A laser hits you. You die.");
                                break;
                            }
                        }
                        var int4 = setInterval(function()
                        {
							if(lost)
							{
								clearInterval(int4);
							}
                            if(score == startscore + time1 + time2)
                            {
                                for(var i = 0;i<41;i++)
                                {
                                    verblockgrid[where][i] = 0;
                                    if(!ifOnSnake(where,i))
                                    {
                                        eraseBlock(where,i);
                                    }
                                }
                                clearInterval(int4);
                            }
                        },110);
                        clearInterval(int3);
                    }
                },110);
            }
            function laserHor(time1,time2)
            {
                var where = snakePos[4].y;
                spawnBlock(0,where,7,"red");
                spawnBlock(1,where,7,"red");
                spawnBlock(2,where,7,"red");
                spawnBlock(width/squLen - 3,where,7,"red");
                spawnBlock(width/squLen - 2,where,7,"red");
                spawnBlock(width/squLen - 1,where,7,"red");
                var startscore = score;
                var int1 = setInterval(function()
                {
					if(lost)
					{
						clearInterval(int1);
					}
                    if(score == startscore + time1)
                    {
                        for(var i = 3;i<width/squLen-3;i++)
                        {
                            spawnBlock(i,where,7,"red");
                        }
                        for(var i = 0;i<width/squLen;i++)
                        {
                            if(ifOnSnake(i,where))
                            {
                                lose("A laser hits you. You die.");
                                alertLost = true;
                                break;
                            }
                        }
                        var int2 = setInterval(function()
                        {
							if(lost)
							{
								clearInterval(int2);
							}
                            if(score == startscore + time1 + time2)
                            {
                                for(var i = 0;i<width/squLen;i++)
                                {
                                    verblockgrid[i][where] = 0;
                                    if(!ifOnSnake(i,where))
                                    {
                                        eraseBlock(i,where);
                                    }
                                }
                                clearInterval(int2);
                            }
                        },110);
                        clearInterval(int1);
                    }
                },110);
            }
            function box(len,time)
            {
                var startscore = score;
                var snakex = snakePos[4].x;
                var snakey = snakePos[4].y;
                for(var i = snakex-len;i<=snakex+len;i++)
                {
					if(i>=0&&i<Math.floor(width/squLen))
					{
						if(snakey-len>=0) spawnBlock(i,snakey-len,7,"red");
						if(snakey+len<40) spawnBlock(i,snakey+len,7,"red");
					}
                }
                for(var i = snakey-len;i<=snakey+len;i++)
                {
					if(i>=0&&i<=40)
					{
						if(snakex-len>=0) spawnBlock(snakex-len,i,7,"red");
						if(snakex+len<Math.floor(width/squLen)) spawnBlock(snakex+len,i,7,"red");
					}
                }
                var int5 = setInterval(function()
                {
                    if(score == startscore+time)
                    {
                        for(var i = snakex-len;i<=snakex+len;i++)
                        {
							if(i>=0&&i<Math.floor(width/squLen))
							{
								if(snakey-len>=0)
								{
									verblockgrid[i][snakey-len] = 0;
									eraseBlock(i,snakey-len);
								}
								if(snakey+len<40)
								{
									verblockgrid[i][snakey+len] = 0;
									eraseBlock(i,snakey+len);
								}
							}
                        }
                        for(var i = snakey-len;i<=snakey+len;i++)
                        {
							if(i>=0&&i<=40)
							{
								if(snakex-len>=0)
								{
									verblockgrid[snakex-len][i] = 0;
									eraseBlock(snakex-len,i);
								}
								if(snakex+len<Math.floor(width/squLen))
								{
									verblockgrid[snakex+len][i] = 0;
									eraseBlock(snakex+len,i);
								}
							}
                        }
                        clearInterval(int5);
                    }
                },110);
            }
            function dlsCoin()
			{
				var spawnx = Math.floor(Math.random() * (width/squLen - 15));
                var spawny = Math.floor(Math.random() * 25);
				spawnBlock(spawnx+5,spawny,11,"yellow");
				spawnBlock(spawnx+6,spawny,11,"yellow");
				spawnBlock(spawnx+7,spawny,11,"yellow");
				spawnBlock(spawnx+8,spawny,11,"yellow");
				spawnBlock(spawnx+9,spawny,11,"yellow");
				
				spawnBlock(spawnx+3,spawny+1,11,"yellow");
				spawnBlock(spawnx+4,spawny+1,11,"yellow");
				spawnBlock(spawnx+10,spawny+1,11,"yellow");
				spawnBlock(spawnx+11,spawny+1,11,"yellow");
				
				spawnBlock(spawnx+2,spawny+2,11,"yellow");
				spawnBlock(spawnx+12,spawny+2,11,"yellow");
				
				spawnBlock(spawnx+1,spawny+3,11,"yellow");
				spawnBlock(spawnx+13,spawny+3,11,"yellow");
				
				spawnBlock(spawnx+1,spawny+4,11,"yellow");
				spawnBlock(spawnx+13,spawny+4,11,"yellow");
				
				spawnBlock(spawnx+0,spawny+5,11,"yellow");
				spawnBlock(spawnx+2,spawny+5,11,"yellow");
				spawnBlock(spawnx+3,spawny+5,11,"yellow");
				spawnBlock(spawnx+6,spawny+5,11,"yellow");
				spawnBlock(spawnx+10,spawny+5,11,"yellow");
				spawnBlock(spawnx+11,spawny+5,11,"yellow");
				spawnBlock(spawnx+14,spawny+5,11,"yellow");
				
				spawnBlock(spawnx+0,spawny+6,11,"yellow");
				spawnBlock(spawnx+2,spawny+6,11,"yellow");
				spawnBlock(spawnx+4,spawny+6,11,"yellow");
				spawnBlock(spawnx+6,spawny+6,11,"yellow");
				spawnBlock(spawnx+9,spawny+6,11,"yellow");
				spawnBlock(spawnx+14,spawny+6,11,"yellow");
				
				spawnBlock(spawnx+0,spawny+7,11,"yellow");
				spawnBlock(spawnx+2,spawny+7,11,"yellow");
				spawnBlock(spawnx+4,spawny+7,11,"yellow");
				spawnBlock(spawnx+6,spawny+7,11,"yellow");
				spawnBlock(spawnx+10,spawny+7,11,"yellow");
				spawnBlock(spawnx+11,spawny+7,11,"yellow");
				spawnBlock(spawnx+14,spawny+7,11,"yellow");
				
				spawnBlock(spawnx+0,spawny+8,11,"yellow");
				spawnBlock(spawnx+2,spawny+8,11,"yellow");
				spawnBlock(spawnx+4,spawny+8,11,"yellow");
				spawnBlock(spawnx+6,spawny+8,11,"yellow");
				spawnBlock(spawnx+12,spawny+8,11,"yellow");
				spawnBlock(spawnx+14,spawny+8,11,"yellow");
				
				spawnBlock(spawnx+0,spawny+9,11,"yellow");
				spawnBlock(spawnx+2,spawny+9,11,"yellow");
				spawnBlock(spawnx+3,spawny+9,11,"yellow");
				spawnBlock(spawnx+6,spawny+9,11,"yellow");
				spawnBlock(spawnx+7,spawny+9,11,"yellow");
				spawnBlock(spawnx+8,spawny+9,11,"yellow");
				spawnBlock(spawnx+10,spawny+9,11,"yellow");
				spawnBlock(spawnx+11,spawny+9,11,"yellow");
				spawnBlock(spawnx+14,spawny+9,11,"yellow");
				
				spawnBlock(spawnx+1,spawny+10,11,"yellow");
				spawnBlock(spawnx+13,spawny+10,11,"yellow");
				
				spawnBlock(spawnx+1,spawny+11,11,"yellow");
				spawnBlock(spawnx+13,spawny+11,11,"yellow");
				
				spawnBlock(spawnx+2,spawny+12,11,"yellow");
				spawnBlock(spawnx+12,spawny+12,11,"yellow");
				
				spawnBlock(spawnx+3,spawny+13,11,"yellow");
				spawnBlock(spawnx+4,spawny+13,11,"yellow");
				spawnBlock(spawnx+10,spawny+13,11,"yellow");
				spawnBlock(spawnx+11,spawny+13,11,"yellow");
				
				spawnBlock(spawnx+5,spawny+14,11,"yellow");
				spawnBlock(spawnx+6,spawny+14,11,"yellow");
				spawnBlock(spawnx+7,spawny+14,11,"yellow");
				spawnBlock(spawnx+8,spawny+14,11,"yellow");
				spawnBlock(spawnx+9,spawny+14,11,"yellow");
			}
			
			
            function changeColor(what)
            {
				if(setMode!="changeColor")
				{
					setMode="changeColor";
					var r = 255;
					var	g = 255;
					var b = 0;
					var loops = 0;
					canvInt = setInterval(function()
					{
						if(loops%1850 < 255)
						{
							r--;
							b++;
							document.getElementById(what).style.backgroundColor = "rgb(" + r +"," + g +"," + b +")";
						}
						else if(loops%1850 < 510)
						{
							g--;
							r++;
							document.getElementById(what).style.backgroundColor = "rgb(" + r +"," + g +"," + b +")";
						}
						else if(loops%1850 < 765)
						{
							b--;
							g++;
							document.getElementById(what).style.backgroundColor = "rgb(" + r +"," + g +"," + b +")";
						}
						else if(loops%1850 < 1020)
						{
							r--;
							document.getElementById(what).style.backgroundColor = "rgb(" + r +"," + g +"," + b +")";
						}
						else if(loops%1850 < 1275)
						{
							g--;
							b++;
							document.getElementById(what).style.backgroundColor = "rgb(" + r +"," + g +"," + b +")";
						}
						else if(loops%1850 < 1530)
						{
							b--;
							r++;
							document.getElementById(what).style.backgroundColor = "rgb(" + r +"," + g +"," + b +")";
						}
						else if(loops%1850 < 1595)
						{
							//do nothing
						}
						else
						{
							g++;
							document.getElementById(what).style.backgroundColor = "rgb(" + r +"," + g +"," + b +")";
						}
						loops++;
					},5);
				}
            }
            function plainWhite(what)
            {
                clearInterval(canvInt);
				setMode="plainWhite";
                document.getElementById(what).style.backgroundColor = "white";
            }
            function plainBlack(what)
            {
                clearInterval(canvInt);
				setMode="plainBlack";
                document.getElementById(what).style.backgroundColor = "black";
            }
            
            function pause()
            {
                if(playing)
                {
                    clearInterval(interval);
                    playing = false;
                }
                else
                {
                    interval = setInterval(function()
                    {
                        runInter();
                    },110);
                    playing = true;
                }
                
            }
        </script>
    </body>
</html>